<?php/** * ApiStatus object * * @author Matt Nischan <nishmaster@gmail.com> * @copyright Copyright &copy; 2010 Matt Nischan */ class ApiStatusObject extends CModel {	const EVE_API_DISABLED = 0;	const EVE_API_ENABLED = 1;	const EVE_API_NO_RESPONSE = 2;	const EVE_API_OFFLINE = 3;	const EVE_API_ONLINE = 4;	private $_status = 0;	private $_players = 0;		function __construct()	{		//Check to see if the API has been disabled by the user		$api = ApiStatus::Model()->findByPk(1);				if ($api->status == self::EVE_API_ENABLED)		{				//Check for a response from the API server			$http = curl_init("https://api.eveonline.com/server/ServerStatus.xml.aspx");			curl_setopt($http, CURLOPT_RETURNTRANSFER, 1);			curl_setopt($http, CURLOPT_TIMEOUT, 10);			$response = curl_exec($http);						if ($response)			{				//Take a look at our response				$xml = new SimpleXMLElement($response);								if ($xml->result->serverOpen == "True")				{					$this->_status = self::EVE_API_ONLINE;					$this->_players = (int)$xml->result->onlinePlayers;					return;				}				else				{					$this->_status = self::EVE_API_OFFLINE;					return;				}			}			else			{				$this->_status = self::EVE_API_NO_RESPONSE;				return;			}		}		else		{			$this->_status = self::EVE_API_DISABLED;			return;		}	}		public function isOnline()	{		if ($this->_status == self::EVE_API_ONLINE)		{			return true;		}		else		{			return false;		}	}			public function status()	{		return $this->_status;	}		public function isEnabled()	{		//Check to see if the API has been disabled by the user		$api = ApiStatus::Model()->findByPk(1);				if ($api->status)		{			return true;		}		else		{			return false;		}	}		public function statusText()	{		switch($this->_status)		{			case 0:				return "API Disabled";				break;			case 1:				return "API Enabled";				break;			case 2:				return "No Response";				break;			case 3:				return "API Offline";				break;			case 4:				return "Online";				break;			default:				return "Error";				break;		}	}		public function players()	{		return $this->_players;	}		public function attributeNames()	{	}}?>