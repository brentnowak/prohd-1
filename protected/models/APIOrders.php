<?phpclass APIOrders extends EVEXMLData{	public function apiAttributes()	{		return array(			'url'=>'http://api.eve-online.com/char/MarketOrders.xml.aspx',			'cacheID'=>'APIOrders',			'primaryID'=>'characterID',			'keys'=>array('keyID','vCode','characterID'),			'storageTable'=>'orders'		);	}	public function storeData($walletID)	{		$attributes = $this->apiAttributes();				//Retrieve the XML dataset		$orders = $this->getEVEData($walletID);				$character = Characters::Model()->findByPk($walletID);		Orders::Model()->deleteAll('charID=:charID',array(':charID'=>$character->characterID));				foreach ($orders->result->rowset->row as $row)		{			$exist = Orders::Model()->exists('orderID=:orderID',array(':orderID'=>$row->attributes()->orderID));			if(!$exist)			{				//echo "ORDERID: {$row->attributes()->orderID} <br>";								$orderRow = new Orders;				$orderRow->orderID = $row->attributes()->orderID;				$orderRow->charID = $row->attributes()->charID;				$orderRow->stationID = $row->attributes()->stationID;				$orderRow->volEntered = $row->attributes()->volEntered;				$orderRow->volRemaining = $row->attributes()->volRemaining;				$orderRow->minVolume = $row->attributes()->minVolume;				$orderRow->orderState = $row->attributes()->orderState;				$orderRow->typeID = $row->attributes()->typeID;				$orderRow->range = $row->attributes()->range;				$orderRow->accountKey = $row->attributes()->accountKey;				$orderRow->duration = $row->attributes()->duration;				$orderRow->escrow = $row->attributes()->escrow;				$orderRow->price = $row->attributes()->price;				$orderRow->bid = $row->attributes()->bid;				$orderRow->issued = $row->attributes()->issued;				$orderRow->save();								//print_r($orderRow->getErrors());						}			else			{				//echo "ORDERID: {$row->attributes()->orderID} <br>";								$orderRow = Orders::Model()->findByPk($row->attributes()->orderID);				$orderRow->orderID = $row->attributes()->orderID;				$orderRow->charID = $row->attributes()->charID;				$orderRow->stationID = $row->attributes()->stationID;				$orderRow->volEntered = $row->attributes()->volEntered;				$orderRow->volRemaining = $row->attributes()->volRemaining;				$orderRow->minVolume = $row->attributes()->minVolume;				$orderRow->orderState = $row->attributes()->orderState;				$orderRow->typeID = $row->attributes()->typeID;				$orderRow->range = $row->attributes()->range;				$orderRow->accountKey = $row->attributes()->accountKey;				$orderRow->duration = $row->attributes()->duration;				$orderRow->escrow = $row->attributes()->escrow;				$orderRow->price = $row->attributes()->price;				$orderRow->bid = $row->attributes()->bid;				$orderRow->issued = $row->attributes()->issued;				$orderRow->save();								//print_r($orderRow->getErrors());			}		}	}}?>